Remnawave Panel ‚Äî –†–æ–ª—å Ansible
==============================


–≠—Ç–∞ —Ä–æ–ª—å —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç **–ø–∞–Ω–µ–ª—å—é Remnawave** —á–µ—Ä–µ–∑ Docker Compose.
–°–±–æ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å—Ç—Ä–æ–≥–æ –ø–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏: https://remna.st/docs/install/remnawave-panel


–ü–∞–Ω–µ–ª—å –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ **–ª–æ–∫–∞–ª—å–Ω–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ (127.0.0.1)**.
–î–æ—Å—Ç—É–ø —Å–Ω–∞—Ä—É–∂–∏ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ **—Ä–µ–≤–µ—Ä—Å‚Äë–ø—Ä–æ–∫—Å–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, nginx –∏–ª–∏ HAProxy).


---


## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø–∞–Ω–µ–ª–∏, PostgreSQL –∏ Redis —á–µ—Ä–µ–∑ Docker Compose
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤ (JWT, PostgreSQL, –º–µ—Ç—Ä–∏–∫–∏)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Telegram‚Äë—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö/–Ω–æ–¥–∞—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞ –ø–∞–Ω–µ–ª–∏ –∏ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞ –¥–ª—è –≤—ã–¥–∞—á–∏ –ø–æ–¥–ø–∏—Å–æ–∫
- –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å (—Ä–æ–ª—å –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ)


---


## üèó –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (—Å–º. `defaults/main.yml`)
| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|----------|
| `remnawave_panel_frontend_domain` | –î–æ–º–µ–Ω –ø–∞–Ω–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `panel.example.com`) |
| `remnawave_panel_sub_public_domain` | –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ–º–µ–Ω –¥–ª—è –ø–æ–¥–ø–∏—Å–æ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `panel.example.com/api/sub`) |
| `remnawave_panel_version` | –í–µ—Ä—Å–∏—è backend‚Äë–æ–±—Ä–∞–∑–∞ Remnawave (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `2`) |
| `remnawave_panel_dir` | –ü—É—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞–Ω–µ–ª–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `/opt/remnawave`) |
| `remnawave_panel_api_instances` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤ API (—á–∏—Å–ª–æ, `-1` ‚Äî –≤—Å–µ —è–¥—Ä–∞ –º–∏–Ω—É—Å 1, `max` ‚Äî –≤—Å–µ —è–¥—Ä–∞) |
| `remnawave_panel_telegram_*` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram‚Äë—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π |
| `remnawave_panel_pg_*` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ PostgreSQL (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å/–ø–∞—Ä–æ–ª—å/–ë–î) |
| `remnawave_panel_env_overrides` | –°–ª–æ–≤–∞—Ä—å –¥–ª—è –¥–æ–ø. –ø–∞—Ä `KEY=VALUE`, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `.env` |


–ï—Å–ª–∏ –∫–∞–∫–∏–µ‚Äë—Ç–æ —Å–µ–∫—Ä–µ—Ç—ã –Ω–µ –∑–∞–¥–∞–Ω—ã ‚Äî –æ–Ω–∏ –±—É–¥—É—Ç **—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**.


---


## üì¶ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
```yaml
- hosts: panel
roles:
- role: remnawave_panel
vars:
remnawave_panel_frontend_domain: panel.vpn-for-friends.com
remnawave_panel_sub_public_domain: panel.vpn-for-friends.com/api/sub
```


---


## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–∞–Ω–µ–ª–∏: `http://127.0.0.1:3001/health`
- –ú–µ—Ç—Ä–∏–∫–∏ Prometheus: `http://127.0.0.1:3001/metrics`


–≠—Ç–∏ URL —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–∞–∫ Ansible‚Äë—Ñ–∞–∫—Ç—ã –∏ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —Ä–æ–ª–∏ `smoke_tests`.


---


## üåê Reverse Proxy (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
–ü–∞–Ω–µ–ª—å **–Ω–µ** –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ nginx/HAProxy –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω–∞ `:443`.


---


## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞–Ω–µ–ª–∏
–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±:
```bash
docker compose pull
docker compose down
docker compose up -d
```
–ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ —Ä–æ–ª–∏ —Ç–∞–∫–∂–µ –≤—ã–ø–æ–ª–Ω–∏—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ.